// È¶ñÈ°µÈ°µÈù¢
const Dashboard = () => {
    const { Row, Col, Card, Statistic, Button, Space, Alert, Progress, Tooltip } = antd;
    const [stats, setStats] = React.useState({});
    const [loading, setLoading] = React.useState(true);
    const [alerts, setAlerts] = React.useState([]);

    React.useEffect(() => {
        // Ê®°ÊãüÊï∞ÊçÆÂä†ËΩΩ
        const loadData = () => {
            setLoading(true);
            setTimeout(() => {
                setStats(MockData.getDashboardStats());
                setAlerts([
                    {
                        type: 'warning',
                        message: 'ÂÆ°Ê†∏ÈòüÂàóÁßØÂéã',
                        description: 'ÂΩìÂâçÂæÖÂÆ°Ê†∏ÂÜÖÂÆπË∂ÖËøá1000Êù°ÔºåÂª∫ËÆÆÂèäÊó∂Â§ÑÁêÜ',
                        time: '5ÂàÜÈíüÂâç'
                    },
                    {
                        type: 'error',
                        message: 'AIÊúçÂä°ÂºÇÂ∏∏',
                        description: 'ÂõæÂÉèËØÜÂà´ÊúçÂä°ÂìçÂ∫îÂºÇÂ∏∏ÔºåÂ∑≤ÂàáÊç¢Ëá≥Â§áÁî®ÊúçÂä°',
                        time: '10ÂàÜÈíüÂâç'
                    }
                ]);
                setLoading(false);
            }, 1000);
        };

        loadData();
        // ÂÆöÊó∂Âà∑Êñ∞Êï∞ÊçÆ
        const interval = setInterval(loadData, 30000);
        return () => clearInterval(interval);
    }, []);

    // ÁªüËÆ°Âç°ÁâáÈÖçÁΩÆ
    const statCards = [
        {
            key: 'pendingReview',
            title: 'ÂæÖÂÆ°Ê†∏ÂÜÖÂÆπ',
            value: stats.pendingReview?.value || 0,
            change: stats.pendingReview?.change || '0%',
            trend: stats.pendingReview?.trend || 'stable',
            icon: 'üîç',
            color: '#f59e42'
        },
        {
            key: 'activeUsers',
            title: 'Ê¥ªË∑ÉÁî®Êà∑',
            value: stats.activeUsers?.value || 0,
            change: stats.activeUsers?.change || '0%',
            trend: stats.activeUsers?.trend || 'stable',
            icon: 'üë•',
            color: '#22c55e'
        },
        {
            key: 'violationRate',
            title: 'ËøùËßÑÁéá',
            value: `${stats.violationRate?.value || 0}%`,
            change: stats.violationRate?.change || '0%',
            trend: stats.violationRate?.trend || 'stable',
            icon: '‚ö†Ô∏è',
            color: '#ef4444'
        },
        {
            key: 'alarmCount',
            title: 'Êä•Ë≠¶Êï∞Èáè',
            value: stats.alarmCount?.value || 0,
            change: stats.alarmCount?.change || '0',
            trend: stats.alarmCount?.trend || 'stable',
            icon: 'üö®',
            color: '#ef4444'
        },
        {
            key: 'contentPublished',
            title: 'ÂÜÖÂÆπÂèëÂ∏É',
            value: stats.contentPublished?.value || 0,
            change: stats.contentPublished?.change || '0%',
            trend: stats.contentPublished?.trend || 'stable',
            icon: 'üìù',
            color: '#2563eb'
        },
        {
            key: 'exhibitionData',
            title: 'Â±ï‰ºöÊï∞ÊçÆ',
            value: stats.exhibitionData?.value || 0,
            change: stats.exhibitionData?.change || '0',
            trend: stats.exhibitionData?.trend || 'stable',
            icon: 'üè¢',
            color: '#8b5cf6'
        },
        {
            key: 'liveCount',
            title: '‰ªäÊó•Áõ¥Êí≠',
            value: stats.liveCount?.value || 0,
            change: stats.liveCount?.change || '0%',
            trend: stats.liveCount?.trend || 'stable',
            icon: 'üé•',
            color: '#f59e42'
        },
        {
            key: 'liveUsers',
            title: '‰ªäÊó•ËßÇÁúã‰∫∫Êï∞',
            value: stats.liveUsers?.value || 0,
            change: stats.liveUsers?.change || '0',
            trend: stats.liveUsers?.trend || 'stable',
            icon: 'üë•',
            color: '#22c55e'
        },
        {
            key: 'activeLiveCount',
            title: 'ËøõË°å‰∏≠Áõ¥Êí≠',
            value: stats.activeLiveCount?.value || 0,
            change: stats.activeLiveCount?.change || '0',
            trend: stats.activeLiveCount?.trend || 'stable',
            icon: 'üé•',
            color: '#f59e42'
        },
        {
            key: 'activeLiveUsers',
            title: 'ËøõË°å‰∏≠ËßÇÁúã‰∫∫Êï∞',
            value: stats.activeLiveUsers?.value || 0,
            change: stats.activeLiveUsers?.change || '0',
            trend: stats.activeLiveUsers?.trend || 'stable',
            icon: 'üë•',
            color: '#22c55e'
        }
    ];

    const getTrendIcon = (trend) => {
        switch (trend) {
            case 'up': return 'üìà';
            case 'down': return 'üìâ';
            default: return '‚û°Ô∏è';
        }
    };

    const getTrendColor = (trend) => {
        switch (trend) {
            case 'up': return '#22c55e';
            case 'down': return '#ef4444';
            default: return '#64748b';
        }
    };

    const renderStatCard = (card) => {
        return React.createElement(Col, {
            key: card.key,
            xs: 24,
            sm: 12,
            md: 8,
            lg: 8,
            xl: 4
        }, React.createElement(Card, {
            className: 'dashboard-card',
            hoverable: true,
            loading: loading,
            style: { height: '140px' },
            bodyStyle: { padding: '20px' }
        }, [
            React.createElement('div', {
                key: 'content',
                style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'flex-start'
                }
            }, [
                React.createElement('div', {
                    key: 'info',
                    style: { flex: 1 }
                }, [
                    React.createElement('div', {
                        key: 'title',
                        style: {
                            fontSize: '14px',
                            color: '#64748b',
                            marginBottom: '8px'
                        }
                    }, card.title),
                    React.createElement(Statistic, {
                        key: 'value',
                        value: card.value,
                        valueStyle: {
                            fontSize: '24px',
                            fontWeight: 'bold',
                            color: card.color
                        }
                    }),
                    React.createElement('div', {
                        key: 'change',
                        style: {
                            marginTop: '8px',
                            display: 'flex',
                            alignItems: 'center',
                            fontSize: '12px',
                            color: getTrendColor(card.trend)
                        }
                    }, [
                        React.createElement('span', {
                            key: 'icon',
                            style: { marginRight: '4px' }
                        }, getTrendIcon(card.trend)),
                        React.createElement('span', {
                            key: 'text'
                        }, card.change)
                    ])
                ]),
                React.createElement('div', {
                    key: 'icon',
                    style: {
                        fontSize: '32px',
                        opacity: 0.6
                    }
                }, card.icon)
            ])
        ]));
    };

    return React.createElement('div', {
        style: { padding: '0' }
    }, [
        // È°µÈù¢Ê†áÈ¢òÂíåÂø´Êç∑Êìç‰Ωú
        React.createElement('div', {
            key: 'header',
            style: {
                marginBottom: '24px',
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center'
            }
        }, [
            React.createElement('h2', {
                key: 'title',
                style: {
                    margin: 0,
                    fontSize: '24px',
                    fontWeight: 'bold',
                    color: '#1e293b'
                }
            }, 'È¶ñÈ°µ'),
            React.createElement(Space, {
                key: 'actions'
            }, [
                React.createElement(Tooltip, {
                    key: 'refresh',
                    title: 'Âà∑Êñ∞Êï∞ÊçÆ'
                }, React.createElement(Button, {
                    icon: React.createElement('span', {}, 'üîÑ'),
                    onClick: () => window.location.reload()
                }, 'Âà∑Êñ∞')),
                React.createElement(Tooltip, {
                    key: 'export',
                    title: 'ÂØºÂá∫Êä•Ë°®'
                }, React.createElement(Button, {
                    type: 'primary',
                    icon: React.createElement('span', {}, 'üìä')
                }, 'ÂØºÂá∫Êä•Ë°®')),
                React.createElement(Tooltip, {
                    key: 'settings',
                    title: 'È¶ñÈ°µËÆæÁΩÆ'
                }, React.createElement(Button, {
                    icon: React.createElement('span', {}, '‚öôÔ∏è')
                }, 'ËÆæÁΩÆ'))
            ])
        ]),

        // Êä•Ë≠¶ÈÄöÁü•Âå∫Âüü
        alerts.length > 0 && React.createElement('div', {
            key: 'alerts',
            style: { marginBottom: '24px' }
        }, alerts.map((alert, index) => 
            React.createElement(Alert, {
                key: `alert-${index}`,
                type: alert.type,
                message: alert.message,
                description: alert.description,
                showIcon: true,
                closable: true,
                style: { marginBottom: '8px' },
                action: React.createElement(Button, {
                    size: 'small',
                    type: 'text'
                }, 'Â§ÑÁêÜ')
            })
        )),

        // ÁªüËÆ°Âç°Áâá
        React.createElement(Row, {
            key: 'stats',
            gutter: [16, 16],
            style: { marginBottom: '24px' }
        }, statCards.map(renderStatCard)),

        // ÂõæË°®ÂíåËØ¶ÁªÜ‰ø°ÊÅØÂå∫Âüü
        React.createElement(Row, {
            key: 'charts',
            gutter: [16, 16]
        }, [
            // Ë∂ãÂäøÂõæË°®
            React.createElement(Col, {
                key: 'trend',
                xs: 24,
                lg: 16
            }, React.createElement(Card, {
                title: 'Áî®Êà∑Ê¥ªË∑ÉË∂ãÂäø',
                className: 'dashboard-card',
                extra: React.createElement(Space, {}, [
                    React.createElement(Button, {
                        key: 'week',
                        size: 'small',
                        type: 'primary'
                    }, '7Â§©'),
                    React.createElement(Button, {
                        key: 'month',
                        size: 'small'
                    }, '30Â§©')
                ])
            }, React.createElement('div', {
                style: {
                    height: '300px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    background: '#f8fafc',
                    borderRadius: '4px'
                }
            }, React.createElement('div', {
                style: { textAlign: 'center', color: '#64748b' }
            }, [
                React.createElement('div', {
                    key: 'icon',
                    style: { fontSize: '48px', marginBottom: '16px' }
                }, 'üìà'),
                React.createElement('div', {
                    key: 'text'
                }, 'Ë∂ãÂäøÂõæË°®Âå∫Âüü')
            ])))),

            // Âø´Êç∑Êìç‰ΩúÈù¢Êùø
            React.createElement(Col, {
                key: 'actions',
                xs: 24,
                lg: 8
            }, React.createElement(Card, {
                title: 'Âø´Êç∑Êìç‰Ωú',
                className: 'dashboard-card'
            }, React.createElement(Space, {
                direction: 'vertical',
                style: { width: '100%' },
                size: 'middle'
            }, [
                React.createElement(Button, {
                    key: 'batch-review',
                    type: 'primary',
                    block: true,
                    size: 'large',
                    icon: React.createElement('span', {}, 'üîç')
                }, 'ÊâπÈáèÂÆ°Ê†∏'),
                React.createElement(Button, {
                    key: 'user-export',
                    block: true,
                    size: 'large',
                    icon: React.createElement('span', {}, 'üë•')
                }, 'Áî®Êà∑Êï∞ÊçÆÂØºÂá∫'),
                React.createElement(Button, {
                    key: 'backup',
                    block: true,
                    size: 'large',
                    icon: React.createElement('span', {}, 'üíæ')
                }, 'Êï∞ÊçÆÂ§á‰ªΩ'),
                React.createElement('div', {
                    key: 'system-status',
                    style: {
                        padding: '16px',
                        background: '#f8fafc',
                        borderRadius: '6px',
                        marginTop: '16px'
                    }
                }, [
                    React.createElement('div', {
                        key: 'title',
                        style: {
                            fontWeight: 'bold',
                            marginBottom: '12px',
                            color: '#1e293b'
                        }
                    }, 'Á≥ªÁªüÁä∂ÊÄÅ'),
                    React.createElement('div', {
                        key: 'cpu',
                        style: { marginBottom: '8px' }
                    }, [
                        React.createElement('span', {
                            key: 'label',
                            style: { fontSize: '12px', color: '#64748b' }
                        }, 'CPU‰ΩøÁî®Áéá'),
                        React.createElement(Progress, {
                            key: 'progress',
                            percent: 65,
                            size: 'small',
                            status: 'active'
                        })
                    ]),
                    React.createElement('div', {
                        key: 'memory',
                        style: { marginBottom: '8px' }
                    }, [
                        React.createElement('span', {
                            key: 'label',
                            style: { fontSize: '12px', color: '#64748b' }
                        }, 'ÂÜÖÂ≠ò‰ΩøÁî®Áéá'),
                        React.createElement(Progress, {
                            key: 'progress',
                            percent: 78,
                            size: 'small',
                            status: 'active'
                        })
                    ])
                ])
            ])))
        ])
    ]);
};

window.Dashboard = Dashboard; 